<!DOCTYPE html>
<html>
  <head>
    <title>Idiogrammatik</title>

    <link rel="stylesheet" href="/idiogrammatik.css">

    <script src="/d3.js"></script>
    <script src="/idiogrammatik.js"></script>
  </head>

  <body>
    <p>Shift-click to highlight regions. <code>kgram</code> is available in the global namespace to add highlights to, extend its functionality, etc..</p>
    <p><pre><code>kgram.highlight('chr2', 0, 'chr4', 0, {color: 'red', opacity: 0.5}); // for example</code></pre></p>
    <script>
     idiogrammatik.__cytoband_url__ = '/cytoband.tsv'
     idiogrammatik.load(function(err, data) {
       if (err)  return console.log('error: ', err);

       var firstPos = null,
           selection = {},
           shifted = false;

       window.onkeydown = function(e) {
         if (e.shiftKey) {
           document.getElementsByTagName("body")[0].style.cursor="text";
           shifted = true;
           try {
             kgram.zoomBehavior().x(null);
           } catch(err) {}
         }
       };
       window.onkeyup = function(e) {
         document.getElementsByTagName("body")[0].style.cursor="default";
         if (shifted && !e.shiftKey) {
           shifted = false;
           kgram.zoomBehavior().x(kgram.scale());
         }
       };

       window.kgram = idiogrammatik()
            .on('dragstart', function(position, kgram) {
               if (!position.chromosome || !shifted) return;
               firstPos = position;
            })
            .on('drag', function(position, kgram) {
               if (!position.chromosome || !shifted) return;
               if (selection.remove) selection.remove();
               selection = kgram.highlight(firstPos, position);
            })
            .on('dragend', function(position, kgram) {
               if (!position.chromosome || !shifted) return;
               if (selection.remove) selection.remove();
               selection = kgram.highlight(firstPos, position);
            });

       d3.select('body')
           .datum(data)
           .call(kgram);

       var highlightChr4 = kgram.highlight('chr4', 0, 'chr5', 0, {color: 'blue'});
     });
    </script>
  </body>

</html>
